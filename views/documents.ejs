<%- include('partials/header') %>

<style>
    /* CSS for API Documents Page - Final Polished Dark Theme v2 */

    /* --- Scrollbar Hiding --- */
    .docs-sidebar, .docs-main-content {
        /* Hide scrollbar for IE, Edge and Firefox */
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    /* Hide scrollbar for Chrome, Safari and Opera */
    .docs-sidebar::-webkit-scrollbar,
    .docs-main-content::-webkit-scrollbar {
        display: none;
    }
    
    /* --- Layout Containers --- */
    .docs-sidebar {
        height: calc(100vh - 58px);
        overflow-y: auto;
        padding: 1rem 0.75rem;
        border-right: 1px solid #343a40;
    }
    .docs-main-content {
        height: calc(100vh - 58px);
        overflow-y: auto;
        color: #ced4da;
        padding: 1.5rem 2.5rem;
    }

    /* --- Sidebar Navigation Styles --- */
    #sidebarNav .nav-link {
        color: #adb5bd;
        padding: 0.5rem 1rem;
        border-left: 3px solid transparent;
        transition: all 0.2s ease-in-out;
        border-radius: 0.3rem;
        margin-bottom: 0.2rem; /* Spacing between links */
    }
    #sidebarNav .nav .nav-link:hover {
        color: #fff;
        background-color: rgba(13, 202, 240, 0.08); /* Subtle hover */
    }
    #sidebarNav .nav-link.active {
        color: #0dcaf0;
        font-weight: 600;
        background-color: rgba(13, 202, 240, 0.1);
        border-left: 3px solid #0dcaf0;
    }
    /* Sub-menu (nested) links */
    #sidebarNav .nav .nav .nav-link {
        padding-left: 1.5rem;
        font-size: 0.9rem;
        color: #8a93a2;
    }
    #sidebarNav .nav .nav .nav-link.active {
       color: #0dcaf0;
       font-weight: 500;
    }
    /* Main section headings in sidebar (as text) */
    .sidebar-heading {
        color: #fff;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.75px;
        padding: 0.75rem 1rem;
        margin-top: 1.25rem;
        margin-bottom: 0.25rem;
    }
    .sidebar-heading:first-of-type {
        margin-top: 0;
    }

    /* --- Main Content Styles --- */
    .docs-section {
        padding-top: 5rem;
        margin-top: -4rem;
    }
    .docs-section h2 {
        color: #fff;
        border-bottom: 2px solid #495057;
        padding-bottom: 0.75rem;
        margin-bottom: 1.5rem;
    }
    .docs-section h4 {
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        color: #0dcaf0;
    }
    .docs-section h5 {
        margin-top: 1.5rem;
        color: #fff;
        font-weight: 600;
    }
    .required { color: #ff6b6b; font-weight: bold; }
    pre {
        background-color: #212529;
        border: 1px solid #495057;
        color: #f8f9fa;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-top: 1rem;
    }
    code { color: #e83e8c; }
    pre code { color: inherit; }
    .endpoint-header {
        background-color: #343a40;
        border: 1px solid #495057;
        color: #f8f9fa;
        border-radius: 0.5rem;
        padding: 1rem;
        font-family: monospace;
        font-size: 1.1rem;
        margin-bottom: 1rem;
    }
    .list-group-item {
        background-color: #343a40;
        border-color: #495057;
        color: #ced4da;
        padding: 0.75rem 1.25rem;
    }
    .alert-warning {
        background-color: rgba(var(--bs-warning-rgb), 0.1);
        border-color: rgba(var(--bs-warning-rgb), 0.3);
        color: #ffc107;
    }
    .alert-info {
        background-color: rgba(var(--bs-info-rgb), 0.1);
        border-color: rgba(var(--bs-info-rgb), 0.3);
        color: #0dcaf0;
    }
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-4 col-lg-3">
            <nav id="sidebarNav" class="d-none d-md-block bg-dark docs-sidebar sticky-top">
                <div class="position-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <p class="sidebar-heading mb-0">เริ่มต้นใช้งาน</p>
                            <ul class="nav flex-column">
                                <li class="nav-item"><a class="nav-link" href="#introduction">บทนำและการตั้งค่า</a></li>
                                <li class="nav-item"><a class="nav-link" href="#authentication">การยืนยันตัวตน</a></li>
                                <li class="nav-item"><a class="nav-link" href="#workflow">ขั้นตอนการทำงาน</a></li>
                            </ul>
                        </li>

                        <li class="nav-item">
                            <p class="sidebar-heading mb-0">Partner <i class="bi bi-arrow-right"></i> Crytek</p>
                            <ul class="nav flex-column">
                                <li class="nav-item"><a class="nav-link" href="#setGameSetting">1. /setGameSetting</a></li>
                                <li class="nav-item"><a class="nav-link" href="#login">2. /login</a></li>
                                <li class="nav-item"><a class="nav-link" href="#gamelist">3. /api/gamelist</a></li>
                            </ul>
                        </li>

                        <li class="nav-item">
                            <p class="sidebar-heading mb-0">Crytek <i class="bi bi-arrow-right"></i> Partner</p>
                             <ul class="nav flex-column">
                                <li class="nav-item"><a class="nav-link" href="#checkBalance">1. /checkBalance</a></li>
                                <li class="nav-item"><a class="nav-link" href="#settleBets">2. /settleBets</a></li>
                            </ul>
                        </li>

                        <li class="nav-item">
                            <p class="sidebar-heading mb-0">API เสริม (Utility)</p>
                             <ul class="nav flex-column">
                                <li class="nav-item"><a class="nav-link" href="#history">/history</a></li>
                                <li class="nav-item"><a class="nav-link" href="#historyall">/historyall</a></li>
                                <li class="nav-item"><a class="nav-link" href="#amount">/amount</a></li>
                            </ul>
                        </li>

                        <li class="nav-item">
                             <p class="sidebar-heading mb-0">อื่นๆ</p>
                             <ul class="nav flex-column">
                                <li class="nav-item"><a class="nav-link" href="#error-codes">Error Codes</a></li>
                             </ul>
                        </li>
                        
                        <li class="nav-item mt-4 border-top border-secondary pt-3">
                            <div class="px-3">
                                <button type="button" class="btn btn-outline-info w-100" data-bs-toggle="modal" data-bs-target="#exampleClassModal">
                                    <i class="bi bi-file-earmark-code"></i> Example Class API
                                </button>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>

        <div class="col-md-8 col-lg-9">
            <main class="docs-main-content" data-bs-spy="scroll" data-bs-target="#sidebarNav" data-bs-offset="120" tabindex="0">
                
                <section class="docs-section" id="introduction">
                    <h2><i class="bi bi-rocket-takeoff-fill"></i> บทนำและการตั้งค่า</h2>
                    <p>เอกสารนี้อธิบายวิธีการเชื่อมต่อ API ของท่าน (Partner) กับระบบเกมของเราผ่าน <strong class="text-primary">Seamless Wallet API</strong> โดยมีเป้าหมายเพื่อให้ผู้เล่นของท่านสามารถเข้าเล่นเกมได้อย่างราบรื่น</p>
                    <p class="lead"><strong>Base URL หลักสำหรับทุก API คือ:</strong></p>
                    <pre><code>https://web-api.cryteksoft.cloud/api/</code></pre>
                    <div class="alert alert-warning mt-4">
                        <h4 class="alert-heading"><i class="bi bi-exclamation-triangle-fill"></i> สิ่งที่ต้องทำก่อนเริ่มต้น (สำคัญมาก)</h4>
                        <ol>
                            <li><strong>ขอรับ API Key และ Secret:</strong> ท่านต้องติดต่อทีมงานของเราเพื่อขอรับ <code>apikey</code> (สำหรับยิงหาเรา) และ <code>secret</code> (สำหรับให้เรายิงหาท่าน)</li>
                            <li><strong>แจ้ง IP Address:</strong> เพื่อความปลอดภัย ระบบของเราจำเป็นต้องทำการ Whitelist IP Address ของเซิร์ฟเวอร์ที่ท่านจะใช้ยิง API มายังระบบของเรา</li>
                            <li><strong>เตรียม Callback URL:</strong> ระบบของท่าน (Partner) จะต้องสร้างและเตรียม Endpoint URL สำหรับให้ระบบของเราติดต่อกลับไปเพื่อตรวจสอบและปรับปรุงยอดเงินของผู้เล่น</li>
                        </ol>
                    </div>
                </section>
                
                <section class="docs-section" id="authentication">
                    <h2><i class="bi bi-key-fill"></i> การยืนยันตัวตน (Authentication)</h2>
                    <p>การยืนยันตัวตนแบ่งเป็น 2 ส่วน:</p>
                    <ul class="list-unstyled">
                        <li class="mb-3">
                            <strong class="text-primary">1. เมื่อ Partner เรียกมายัง API ของเรา:</strong><br>
                            ทุกๆ Request จะต้องมี HTTP Header <code>x-api-key</code> ซึ่งเป็นค่า <code>apikey</code> ที่ท่านได้รับจากเรา
                            <pre><code class="language-json">{ "Content-Type": "application/json", "x-api-key": "YOUR_PARTNER_APIKEY_HERE" }</code></pre>
                        </li>
                        <li>
                            <strong class="text-info">2. เมื่อระบบของเราเรียกไปยัง Callback URL ของ Partner:</strong><br>
                            ทุกๆ Callback ที่เราส่งไป จะมี Header <code>x-api-key</code> ซึ่งเป็นค่า <code>secret</code> ที่เราออกให้ท่าน เพื่อให้ท่านตรวจสอบว่าเป็น Request ที่มาจากระบบของเราจริง
                             <pre><code class="language-json">{ "Content-Type": "application/json", "x-api-key": "YOUR_CALLBACK_SECRET_HERE" }</code></pre>
                        </li>
                    </ul>
                </section>

                <section class="docs-section" id="workflow">
                    <h2><i class="bi bi-diagram-3-fill"></i> ขั้นตอนการทำงาน (Seamless Wallet Workflow)</h2>
                    <p>การทำงานเป็นแบบ <strong class="text-primary">Seamless Wallet</strong> ซึ่งหมายถึงไม่มีการโอนเงิน (Transfer) เข้า-ออกจากกระเป๋าเกม แต่จะเป็นการสื่อสารเพื่อตรวจสอบและอัปเดตยอดเงินในกระเป๋าหลักของ Partner แบบ Real-time ผ่าน Callback</p>
                    <ol class="list-group list-group-numbered">
                        <li class="list-group-item"><strong>สร้าง Session:</strong> Partner เรียก <code>POST /setGameSetting</code> เพื่อรับ <code>sessionToken</code></li>
                        <li class="list-group-item"><strong>ขอลิงก์เกม:</strong> Partner นำ <code>sessionToken</code> มาเรียก <code>POST /login</code> เพื่อรับ URL สำหรับเข้าเล่นเกม</li>
                        <li class="list-group-item"><strong>ผู้เล่นเข้าเกม:</strong> Partner แสดง URL ให้ผู้เล่น (เช่น iFrame)</li>
                        <li class="list-group-item"><strong>ตรวจสอบยอดเงิน:</strong> ระบบเกมจะยิง Callback มายัง <code>/checkBalance</code> ของ Partner เพื่อขอยอดเงินคงเหลือ</li>
                        <li class="list-group-item"><strong>ปรับปรุงยอดเงิน:</strong> เมื่อมีการเดิมพัน (แพ้/ชนะ) ระบบเกมจะยิง Callback มายัง <code>/settleBets</code> ของ Partner ทันทีเพื่อปรับปรุงยอดเงิน</li>
                    </ol>
                </section>

                <section class="docs-section" id="api-endpoints">
                    <h2><i class="bi bi-cloud-arrow-up-fill"></i> API Endpoints (Partner <i class="bi bi-arrow-right"></i> Crytek)</h2>
                    <p>Endpoints ที่ Partner จะต้องเรียกมายังเซิร์ฟเวอร์ของเรา</p>
                    
                    <article id="setGameSetting" class="mb-5">
                        <h4 class="mt-4">1. สร้าง/ตั้งค่าผู้เล่น และรับ Session Token</h4>
                        <p>ใช้สำหรับสร้างผู้เล่นใหม่ หรืออัปเดตการตั้งค่า (Setting) สำหรับผู้เล่นที่มีอยู่แล้ว เพื่อปรับพฤติกรรมของเกม และจะได้รับ <code>sessionToken</code> เพื่อใช้ในขั้นตอนต่อไป</p>
                        <div class="endpoint-header"><span class="badge bg-primary fs-6 me-3">POST</span>/setGameSetting</div>
                        <h5>Request Body</h5>
                        <table class="table table-dark table-bordered table-striped">
                            <thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><code>username</code> <span class="required">*</span></td><td>String</td><td>Username ของผู้เล่นในระบบของ Partner</td></tr>
                                <tr><td><code>gameCode</code></td><td>String</td><td>(Optional) รหัสเกมที่ต้องการใช้การตั้งค่านี้</td></tr>
                                <tr><td><code>setting</code></td><td>Array</td><td>(Optional) Array ของ Object สำหรับตั้งค่าการหมุนแบบปกติ</td></tr>
                                <tr><td><code>buyFeatureSetting</code></td><td>Array</td><td>(Optional) Array ของ Object สำหรับตั้งค่าการซื้อฟีเจอร์</td></tr>
                            </tbody>
                        </table>
                        <h5 class="mt-4">ตัวอย่าง Request Body (แบบเต็ม)</h5>
                        <p>หากไม่ส่งค่า `setting` หรือ `buyFeatureSetting` ระบบจะใช้ค่าเริ่มต้น</p>
                        <pre><code class="language-json">{
    "username": "player001",
    "gameCode": "fortune-tiger",
    "isPlayerSetting": true,
    "setting": [
        { "name": "normal-spin", "output": "normal-spin", "percent": 90 },
        { "name": "less-bet", "output": "less-bet", "percent": 5, "option": { "from": 0, "to": 1 } },
        { "name": "more-bet", "output": "more-bet", "percent": 5, "option": { "from": 0, "to": 4 } },
        { "name": "freespin-less-bet", "output": "freespin-less-bet", "percent": 1, "option": { "from": 0, "to": 30 } },
        { "name": "freespin-more-bet", "output": "freespin-more-bet", "percent": 0, "option": { "from": 0, "to": 0 } }
    ],
    "buyFeatureSetting": [
        { "name": "buy-feature-less-bet", "output": "freespin-less-bet", "percent": 90, "option": { "from": 0, "to": 40 } },
        { "name": "buy-feature-more-bet", "output": "freespin-more-bet", "percent": 10, "option": { "from": 0, "to": 100 } }
    ]
}</code></pre>
                        <h5>ตัวอย่าง Response (Success)</h5>
                        <p>ระบบจะตอบกลับเป็น <code>sessionToken</code> (เป็นค่า string) ซึ่งมีอายุการใช้งานสั้นๆ สำหรับใช้ใน API <code>/login</code> ต่อไป</p>
                        <pre><code>"a1b2c3d4-e5f6-7890-1234-567890abcdef"</code></pre>
                    </article>

                    <article id="login" class="mb-5">
                        <h4 class="mt-4">2. ขอลิงก์สำหรับเข้าเกม (Get Game Launch URL)</h4>
                         <p>ใช้ <code>sessionToken</code> ที่ได้รับจากขั้นตอนก่อนหน้าเพื่อขอรับ URL สำหรับการเข้าเล่นเกม</p>
                         <div class="endpoint-header"><span class="badge bg-primary fs-6 me-3">POST</span>/login</div>
                         <h5>Request Body</h5>
                        <table class="table table-dark table-bordered table-striped">
                            <thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><code>username</code> <span class="required">*</span></td><td>String</td><td>Username ของผู้เล่น (ต้องตรงกับที่ใช้ใน <code>/setGameSetting</code>)</td></tr>
                                <tr><td><code>sessionToken</code> <span class="required">*</span></td><td>String</td><td>Token ที่ได้รับจาก API <code>/setGameSetting</code></td></tr>
                                <tr><td><code>gameCode</code> <span class="required">*</span></td><td>String</td><td>รหัสของเกมที่ต้องการเล่น (ดูวิธีการได้จาก <a href="#gamelist">API ดึงรายชื่อเกม</a>)</td></tr>
                                <tr><td><code>game</code></td><td>String</td><td>(Optional) ค่ายเกมที่ต้องการเล่น เช่น <code>jl</code> (JILI), <code>joker</code> (Joker)</td></tr>
                            </tbody>
                        </table>
                        <h5>ตัวอย่าง Response (Success)</h5>
                        <pre><code class="language-json">{ "success": true, "url": "https://m.elite-gamesoft.com/1827457/..." }</code></pre>
                    </article>

                    <article id="gamelist" class="mb-5">
                        <h4 class="mt-4">3. ดึงรายชื่อเกม (Get Game List)</h4>
                        <p>ใช้สำหรับดึงรายชื่อเกมและ <code>gameCode</code> ที่สามารถใช้งานได้ เพื่อนำไปใช้ใน API <code>/login</code></p>
                        <div class="alert alert-info"><strong>Endpoint URL:</strong> <code>https://games-api.cryteksoft.cloud/api/gamelist</code></div>
                        <div class="endpoint-header"><span class="badge bg-info fs-6 me-3">GET</span>/api/gamelist</div>
                        <h5>Query Parameters</h5>
                        <table class="table table-dark table-bordered table-striped">
                            <thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead>
                            <tbody><tr><td><code>provider</code> <span class="required">*</span></td><td>String</td><td>ค่ายเกมที่ต้องการดึงรายชื่อ มีค่าที่เป็นไปได้: <code>PG</code>, <code>JOKER</code>, <code>JILI</code>, <code>PP</code></td></tr></tbody>
                        </table>
                        <h5>ตัวอย่าง URL</h5>
                        <pre><code>https://games-api.cryteksoft.cloud/api/gamelist?provider=PG</code></pre>
                        <h5>ตัวอย่าง Response (Success)</h5>
                        <pre><code class="language-json">[
    { "gameName": "Fortune Tiger", "gameCode": "fortune-tiger" },
    { "gameName": "Mahjong Ways 2", "gameCode": "mahjong-ways2" },
    // ... more games
]</code></pre>
                    </article>
                </section>

                <section class="docs-section" id="callback-endpoints">
                     <h2 class="mt-5"><i class="bi bi-cloud-arrow-down-fill"></i> Callback Endpoints (Crytek <i class="bi bi-arrow-right"></i> Partner)</h2>
                     <p>ท่านจำเป็นต้องสร้าง API Endpoint เหล่านี้บนเซิร์ฟเวอร์ของท่าน และแจ้ง URL ให้เราทราบ</p>

                    <article id="checkBalance" class="mt-4">
                        <h4>1. ตรวจสอบยอดเงิน (Check Balance)</h4>
                        <p>ระบบของเราจะเรียกมาที่ Endpoint นี้เพื่อขอยอดเงินคงเหลือล่าสุดของผู้เล่นก่อนเข้าเกม</p>
                        <div class="endpoint-header"><span class="badge bg-success fs-6 me-3">POST</span>/your-checkBalance-url</div>
                        <h5>Request ที่ท่านจะได้รับ</h5>
                        <pre><code class="language-json">{ "username": "player001_in_partner_system" }</code></pre>
                        <h5>Response ที่ท่านต้องส่งกลับ</h5>
                         <table class="table table-dark table-bordered table-striped">
                            <thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><code>balance</code> <span class="required">*</span></td><td>Number</td><td>ยอดเงินคงเหลือของผู้เล่น (ทศนิยม 2 ตำแหน่ง)</td></tr>
                                <tr><td><code>statusCode</code> <span class="required">*</span></td><td>Number</td><td>สถานะการทำรายการ (<code>0</code> หมายถึงสำเร็จ)</td></tr>
                            </tbody>
                        </table>
                    </article>

                    <article id="settleBets" class="mt-5">
                        <h4>2. ปรับปรุงยอดเงิน (Settle Bets)</h4>
                        <p>ระบบของเราจะเรียกมาที่ Endpoint นี้เมื่อมีการเดิมพันเกิดขึ้น เพื่อให้ท่านปรับปรุงยอดเงินของผู้เล่น (ลดเครดิตตอนเดิมพัน, เพิ่มเครดิตตอนชนะ)</p>
                         <div class="endpoint-header"><span class="badge bg-success fs-6 me-3">POST</span>/your-settleBets-url</div>
                        <h5>Request ที่ท่านจะได้รับ</h5>
                        <pre><code class="language-json">{
    "id": "txn_123456789",
    "username": "player001_in_partner_system",
    "txns": [ { "betAmount": 10.00, "payoutAmount": 50.00, ... } ]
}</code></pre>
                        <div class="alert alert-info">
                            <strong>การคำนวณยอดเงิน:</strong> ท่านต้องนำยอด <code>betAmount</code> ไปหักออกจากเครดิต และนำยอด <code>payoutAmount</code> ไปเพิ่มเข้าเครดิตของผู้เล่น
                        </div>
                        <h5>Response ที่ท่านต้องส่งกลับ</h5>
                        <table class="table table-dark table-bordered table-striped">
                            <thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><code>id</code> <span class="required">*</span></td><td>String</td><td>Transaction ID ที่ได้รับมาใน Request</td></tr>
                                <tr><td><code>statusCode</code> <span class="required">*</span></td><td>Number</td><td>สถานะ (<code>0</code> = สำเร็จ)</td></tr>
                                <tr><td><code>balanceBefore</code> <span class="required">*</span></td><td>Number</td><td>ยอดเงินของผู้เล่น <strong>ก่อน</strong> การปรับปรุง</td></tr>
                                <tr><td><code>balanceAfter</code> <span class="required">*</span></td><td>Number</td><td>ยอดเงินของผู้เล่น <strong>หลัง</strong> การปรับปรุง</td></tr>
                                <tr><td><code>username</code> <span class="required">*</span></td><td>String</td><td>Username ที่ได้รับมาใน Request</td></tr>
                            </tbody>
                        </table>
                    </article>
                </section>
                
                <section class="docs-section" id="utility-endpoints">
                     <h2 class="mt-5"><i class="bi bi-tools"></i> API เสริม (Utility & Reports)</h2>
                     <p>Endpoints สำหรับดึงข้อมูลสรุปและประวัติต่างๆ ที่ Partner สามารถเรียกใช้ได้</p>

                    <article id="history" class="mt-4">
                        <h4>ดูประวัติการเล่น (รายบุคคล)</h4>
                         <div class="endpoint-header"><span class="badge bg-info fs-6 me-3">POST</span>/history</div>
                        <h5>Request Body</h5>
                        <pre><code>{ "username": "player001" }</code></pre>
                        <h5>Response</h5>
                        <p>ตอบกลับเป็น Array ของ Transaction object ของผู้เล่นคนนั้นๆ</p>
                    </article>

                    <article id="historyall" class="mt-4">
                        <h4>ดูประวัติการเล่นทั้งหมด (ตามช่วงเวลา)</h4>
                        <div class="endpoint-header"><span class="badge bg-info fs-6 me-3">POST</span>/historyall</div>
                        <h5>Request Body</h5>
                        <pre><code class="language-json">{
  "start": "2024-01-01T00:00:00.000Z",
  "end": "2024-01-31T23:59:59.999Z"
}</code></pre>
                        <h5>Response</h5>
                        <p>ตอบกลับเป็น Object ที่มี <code>data</code> (Array of Transactions) และ <code>Total</code> (สรุปยอด bet/win)</p>
                    </article>

                    <article id="amount" class="mt-4">
                        <h4>ดูยอดรวม แพ้/ชนะ (รายบุคคล)</h4>
                        <div class="endpoint-header"><span class="badge bg-info fs-6 me-3">POST</span>/amount</div>
                        <h5>Request Body</h5>
                        <pre><code>{ "username": "player001" }</code></pre>
                         <h5>Response</h5>
                        <p>ตอบกลับเป็น Array ที่มี Object สรุปยอด <code>total_bet_all</code> และ <code>total_win_all</code></p>
                    </article>
                </section>

                <section class="docs-section" id="error-codes">
                    <h2><i class="bi bi-shield-exclamation"></i> Error Codes</h2>
                    <p><code>statusCode</code> ที่ใช้ในการสื่อสารระหว่างระบบ โดยเฉพาะในส่วน Callback</p>
                    <table class="table table-dark table-bordered table-hover">
                         <thead><tr><th>Code</th><th>Description</th></tr></thead>
                         <tbody>
                             <tr><td><code>0</code></td><td><span class="badge bg-success">Success</span></td></tr>
                             <tr><td><code>9</code></td><td><span class="badge bg-info">Timeout or internal error</span> (หมดเวลาการเชื่อมต่อ หรือเกิดข้อผิดพลาดภายใน)</td></tr>
                             <tr><td><code>30001</code></td><td><span class="badge bg-warning text-dark">Player not found / Invalid session / Not enough credit</span> (ผู้เล่นไม่ถูกต้อง / เซสชั่นหมดอายุ / เครดิตไม่เพียงพอ)</td></tr>
                             <tr><td><code>50001</code></td><td><span class="badge bg-danger">General error</span> (เกิดข้อผิดพลาดทั่วไปในระบบ)</td></tr>
                         </tbody>
                    </table>
                </section>

            </main>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleClassModal" tabindex="-1" aria-labelledby="exampleClassModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content bg-dark text-light">
      <div class="modal-header border-secondary">
        <h5 class="modal-title" id="exampleClassModalLabel">Class_cryteksoft API Nodejs</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <pre><code class="language-javascript">
const axios = require("axios");

class api_pg {
  constructor(
    func_db,
    api_key = null,
    agent = null,
    endpoint = "https://web-api.cryteksoft.cloud"
  ) {
    this._ENDPOINT = endpoint;
    this._KEY_NEW = api_key;
    this._AGENT = agent;
    this.db_read = func_db;
  }

  async get_dbset() {
    try {
      const agent = await this.db_read.get_agentsPgOne();
      this._ENDPOINT = "https://web-api.cryteksoft.cloud";

      this._KEY_NEW = agent.api_key;

      return agent;
    } catch (err) {
      console.log(String(err));
    }
  }
  async get_allgame() {
    try {
      let data = "";

      let config = {
        method: "get",
        maxBodyLength: Infinity,
        url: this._ENDPOINT + "/gameall.json",
        headers: {
          "x-api-key": this._KEY_NEW,
        },
        data: data,
      };

      const result = await axios.request(config);

      return result.data;
    } catch (err) {
      console.log("ALL GAME", err);
      return "error";
    }
  }
  async loadsetting(user, gamecode) {
    var dbload = await this.db_read.get_loadsetting();

    let myloadsetting = {};
    dbload.map((val) => {
      myloadsetting = { ...myloadsetting, [val.name]: val.value };
    });

    try {
      let data = JSON.stringify({
        gameCode: gamecode,
        setting: [
          {
            name: "normal-spin",
            output: "normal-spin",
            percent: parseInt(myloadsetting["normal-spin"]),
          },
          {
            name: "less-bet",
            output: "less-bet",
            percent: parseInt(myloadsetting["less-bet"]),
            option: {
              from: parseInt(myloadsetting["less-bet-from"]),
              to: parseInt(myloadsetting["less-bet-to"]),
            },
          },
          {
            name: "more-bet",
            output: "more-bet",
            percent: parseInt(myloadsetting["more-bet"]),
            option: {
              from: parseInt(myloadsetting["more-bet-from"]),
              to: parseInt(myloadsetting["more-bet-to"]),
            },
          },
          {
            name: "freespin-less-bet",
            output: "freespin-less-bet",
            percent: parseInt(myloadsetting["freespin-less-bet"]),
            option: {
              from: parseInt(myloadsetting["freespin-less-bet-from"]),
              to: parseInt(myloadsetting["freespin-less-bet-to"]),
            },
          },
          {
            name: "freespin-more-bet",
            output: "freespin-more-bet",
            percent: parseInt(myloadsetting["freespin-more-bet"]),
            option: {
              from: parseInt(myloadsetting["freespin-more-bet-from"]),
              to: parseInt(myloadsetting["freespin-more-bet-to"]),
            },
          },
        ],
        username: user,
        isPlayerSetting: true,
        buyFeatureSetting: [
          {
            name: "buy-feature-less-bet",
            output: "freespin-less-bet",
            percent: parseInt(myloadsetting["buy-feature-less-bet"]),
            option: {
              from: parseInt(myloadsetting["buy-feature-less-bet-from"]),
              to: parseInt(myloadsetting["buy-feature-less-bet-to"]),
            },
          },
          {
            name: "buy-feature-more-bet",
            output: "freespin-more-bet",
            percent: parseInt(myloadsetting["buy-feature-more-bet"]),
            option: {
              from: parseInt(myloadsetting["buy-feature-more-bet-from"]),
              to: parseInt(myloadsetting["buy-feature-more-bet-to"]),
            },
          },
        ],
      });

      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: this._ENDPOINT + "/api/setGameSetting",
        headers: {
          "x-api-key": this._KEY_NEW,
          "Content-Type": "application/json",
        },
        data: data,
      };

      const result = await axios.request(config);

      return result.data;
    } catch (err) {
      if (err.response) {
        console.log("Error", err.response);
        return err.response.data;
      } else {
        return String(err);
      }
    }
  }
  async loadsettingBy(user, gamecode, bytb) {
    var dbload = await this.db_read.get_loadsetting();
    if (bytb == "user") {
      var get_user = await this.db_read.get_settingPGuser(user);
    } else if (bytb == "game") {
      var get_user = await this.db_read.get_settingPGuser(gamecode);
    }
    if (get_user !== "not found") {
      var data2 = get_user;
      for (let i = 0; i < dbload.length; i++) {
        const item = dbload[i];
        const itemName = item.name;

        // Check if the name exists in data2
        if (data2.hasOwnProperty(itemName)) {
          // Update the value property with the corresponding value from data2
          item.value = data2[itemName];
        }
      }
    }

    let myloadsetting = {};
    dbload.map((val) => {
      myloadsetting = { ...myloadsetting, [val.name]: val.value };
    });

    try {
      let data = JSON.stringify({
        gameCode: gamecode,
        setting: [
          {
            name: "normal-spin",
            output: "normal-spin",
            percent: parseInt(myloadsetting["normal-spin"]),
          },
          {
            name: "less-bet",
            output: "less-bet",
            percent: parseInt(myloadsetting["less-bet"]),
            option: {
              from: parseInt(myloadsetting["less-bet-from"]),
              to: parseInt(myloadsetting["less-bet-to"]),
            },
          },
          {
            name: "more-bet",
            output: "more-bet",
            percent: parseInt(myloadsetting["more-bet"]),
            option: {
              from: parseInt(myloadsetting["more-bet-from"]),
              to: parseInt(myloadsetting["more-bet-to"]),
            },
          },
          {
            name: "freespin-less-bet",
            output: "freespin-less-bet",
            percent: parseInt(myloadsetting["freespin-less-bet"]),
            option: {
              from: parseInt(myloadsetting["freespin-less-bet-from"]),
              to: parseInt(myloadsetting["freespin-less-bet-to"]),
            },
          },
          {
            name: "freespin-more-bet",
            output: "freespin-more-bet",
            percent: parseInt(myloadsetting["freespin-more-bet"]),
            option: {
              from: parseInt(myloadsetting["freespin-more-bet-from"]),
              to: parseInt(myloadsetting["freespin-more-bet-to"]),
            },
          },
        ],
        username: user,
        isPlayerSetting: true,
        buyFeatureSetting: [
          {
            name: "buy-feature-less-bet",
            output: "freespin-less-bet",
            percent: parseInt(myloadsetting["buy-feature-less-bet"]),
            option: {
              from: parseInt(myloadsetting["buy-feature-less-bet-from"]),
              to: parseInt(myloadsetting["buy-feature-less-bet-to"]),
            },
          },
          {
            name: "buy-feature-more-bet",
            output: "freespin-more-bet",
            percent: parseInt(myloadsetting["buy-feature-more-bet"]),
            option: {
              from: parseInt(myloadsetting["buy-feature-more-bet-from"]),
              to: parseInt(myloadsetting["buy-feature-more-bet-to"]),
            },
          },
        ],
      });

      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: this._ENDPOINT + "/api/setGameSetting",
        headers: {
          "x-api-key": this._KEY_NEW,
          "Content-Type": "application/json",
        },
        data: data,
      };

      const result = await axios.request(config);
      // console.log("OK USER GAME",data)
      return result.data;
    } catch (err) {
      return "error";
    }
  }
  async loginuser(user, gamecode, sessionToken, game = "pg") {
    try {
      let data = JSON.stringify({
        username: user,
        gameCode: gamecode,
        sessionToken: sessionToken,
        language: "th",
        game: game,
      });

      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: this._ENDPOINT + "/api/login",
        headers: {
          "x-api-key": this._KEY_NEW,
          "Content-Type": "application/json",
        },
        data: data,
      };

      const result = await axios.request(config);

      return result.data;
      //  console.log(this._KEY_NEW);
    } catch (err) {
      return "error";
    }
  }
  async deluser() {
    try {
      let data = JSON.stringify({
        gameCode: "lucky-neko",
        username: "sdaws",
      });
      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: this._ENDPOINT + "/seamless/api/v2/login",
        headers: {
          "x-api-key": this._KEY_NEW,
          "Content-Type": "application/json",
        },
        data: data,
      };

      const result = await axios.request(config);

      return result.data;
    } catch (err) {
      if (err.response) {
        return err.response.data;
      } else {
        return String(err);
      }
    }
  }
}

module.exports = api_pg;
        </code></pre>
      </div>
      <div class="modal-footer border-secondary">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>